
<!--
`<bloombox-price>` provides UI for a single price value and label.

@group Bloombox Elements
@element bloombox-price
@demo demo/index.html
@homepage bloombox.github.io
-->

<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-input/paper-input.html">
<link rel="import" href="../paper-checkbox/paper-checkbox.html">
<link rel="import" href="../bloombox-styles/bloombox-styles.html">


<dom-module id="bloombox-price">
  <template>
    <style is="custom-style" include="bloombox-styles">
      :host {
        display: inline-block;
        margin: 8px;
        text-align: center;
        color: #444;
        background: #DDD;
      }

      :host.unavailable {
        background: rgba(221, 221, 221, 0.75);
      }

      :host .price-wrap {
        height: 100%;
        width: 100%;
        min-width: 65px;
        min-height: 75px;
        position: relative;
      }

      :host .price-content {
        font-size: 16pt;
        padding: 5px;
        min-height: 35px;
        line-height: 35px;
      }

      :host paper-input {
        display: inline-block;
        max-width: 70px;
      }

      :host .price-label {
        background: #444;
        color: #DDD;
        height: 25px;
        line-height: 25px;
        font-size: 80%;
        text-transform: uppercase;
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
      }

      :host .variant-available {
        padding: 10px;
        padding-bottom: 30px;
        position: relative;
        top: -5px;
        display: flex;
      }

      :host .available-label {
        display: block;
        text-transform: uppercase;
        font-size: 80%;
        margin-top: 4px;
      }
    </style>

    <div class="price-wrap">
      <!-- pricebox content -->
      <div class="price-content">
        <template is="dom-if" if="{{editable}}">
          <span class="price-currency">{{currency}}</span>
          <paper-input class="priceField" placeholder="0.00" value="{{price}}" required no-label-float name="price" class="form-item strain-price-input"></paper-input>
        </template>
        <template is="dom-if" if="{{!editable}}">
          <span class="price-value">{{currency}}{{_formatPrice(price)}}</span>
        </template>
      </div>

      <!-- availability -->
      <template is="dom-if" if="{{editable}}">
        <div class="variant-available">
          <paper-checkbox noink class="stateToggle" checked="{{available}}" class="price-item item-available"></paper-checkbox>
          <span class="available-label">Available</span>
        </div>
      </template>
      <!-- end availability -->
      <!-- end content -->

      <!-- pricebox label -->
      <template is="dom-if" if="{{label}}">
        <div class="price-label">
          <span class="price-label-value">{{label}}</span>
        </div>
      </template>
      <!-- end label -->
    </div>
  </template>

  <script>
    Polymer.BloomboxPrice = Polymer({
      is: 'bloombox-price',
      properties: {
        /**
         * Label to put underneath this price box. Usually either `"each"` (for unit
         * based pricing) or a named weight, such as `"gram"` or `"ounce"`.
         */
        label: {
          type: String,
          notify: true,
          value: 'each',
          reflectToAttribute: true
        },

        /**
         * Price value of this item (and at this weight, if specified).
         */
        price: {
          type: Number,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Boolean flag indicating whether this item/price combination is currently
         * available, or is not available and is currently out-of-stock.
         */
        available: {
          type: Boolean,
          value: true,
          notify: true,
          reflectToAttribute: true
        },

        /**
         * Currency symbol to show in front of the price.
         */
        currency: {
          type: String,
          notify: true,
          reflectToAttribute: true,
          value: '$'
        },

        /**
         * Boolean flag indicating whether we should be editing this price, and
         * showing an input box accordingly.
         */
        editable: {
          type: Boolean,
          value: false,
          notify: true,
          reflectToAttribute: true
        }
      },

      /**
       * Format a price value with the proper number of trailing zeros, or remove
       * the trailing zeros altogether if they balance out to `.0`.
       */
      _formatPrice: function(price) {
        return ("" + price).endsWith(".0") ? ("" + price).replace(".0", "") : "" + price;
      }
    });
  </script>
</dom-module>
